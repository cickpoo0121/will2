<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/responsive/2.2.3/css/responsive.bootstrap4.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.3/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.2.3/js/responsive.bootstrap4.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <script src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>
    <title>การตรวจสอบและนับครุภัณฑ์</title>
</head>
<style>
    #log {
        width: 100px;
    }

    .date {
        color: #fc0000;
        ;
    }

    .highlightRow {
        color: red;
    }.nav-user {}

.nav-user-dropdown {
    padding: 0px;
    min-width: 230px;
    margin: 0px;
}

.nav-user-name {}

.nav-user-info {
    background-color: blue;
    line-height: 1.2;
    padding: 12px;
    color: #fff;
    font-size: 13px;
    border-radius: 2px 2px 0 0;
}

.nav-user-info .status {
    float: left;
    top: 7px;
    left: 0px;
}

.nav-user-dropdown {}

.nav-user-dropdown .dropdown-item {
    display: block;
    width: 100%;
    padding: 12px 22px 15px;
    clear: both;
    font-weight: 400;
    color: #686972;
    text-align: inherit;
    white-space: nowrap;
    background-color: transparent;
    border: 0;
    font-size: 13px;
    line-height: 0.4;
}

.nav-user-dropdown .dropdown-item:hover {
    /* background-color: #f7f7fb; */
    color: blue;
}

.nav-user .dropdown-toggle::after {
    display: inline-block;
    width: 0;
    height: 0;
    margin-left: .255em;
    vertical-align: .255em;
    content: "";
    border: none;
}

.nav-user-dropdown {
    padding: 0px;
    margin: 0px;
    margin-top: 74px;

}
</style>

<body>
    <!-- Header -->
    <div class="row">
        <div class="col-md-9">
            <img src="../img/banner.png" alt="LOGO" style="width: 450px;">
        </div>
        <div class="col-md-3">

            <!-- <li class="nav-item dropdown nav-user"> -->
            <a class="nav-link nav-user-img" href="#" id="navbarDropdownMenuLink2" data-toggle="dropdown"
                aria-haspopup="true" aria-expanded="false"><img src="" id="imguser" alt=""
                    class="user-avatar-md rounded-circle mt-3 float-right " style="width: 50px;height: 50px;"></a>
            <div class="dropdown-menu dropdown-menu-right nav-user-dropdown" aria-labelledby="navbarDropdownMenuLink2">
                <div class="nav-user-info">
                    <h6 class="mb-0 text-white nav-user-name " id="NameUser">John Abraham </h6>
                    <!-- <span class="ml-2">Available</span> -->

                </div>
                <a class="dropdown-item" href="/auth/logout">
                    <h6><i class="fas fa-power-off mr-2"></i>Logout</h6>
                </a>
            </div>
            <!-- </li> -->

        </div>
    </div>
    <!-- Header -->

    <!-- Menu -->
    <div>

        <nav class="navbar navbar-expand-lg navbar-light  " style="background-color: #253b6d;">
            <a class="navbar-brand ml-5" href="#"></a>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item active ml-5">
                        <a href="/committeefirstpage" class="nav-link text-light ">หน้าแรก</a>
                    </li>

                    <li class="nav-item ml-5">
                        <a class="nav-link text-light" href="/committee_AssetStatus">สถานะครุภัณฑ์</a>
                    </li>
                    <li class="nav-item ml-5">
                        <a class="nav-link text-light " href="/committeeBiodata">คณะกรรมการประจำปี</a>
                    </li>
                    <li class="nav-item ml-5">
                        <a class="btn btn-rounded btn-light  " href="/periodOfCheckingAsset">เวลาการตรวจสอบครุภัณฑ์</a>
                    </li>
                </ul>
            </div>
        </nav>
    </div>

    <div class="row">
        <div class="col-sm-12 mt-3">
            <div class="card">
                <div class="card-header">
                    <div class="row">
                        <div class="col-md-4">
                            <h2>ระยะเวลาการตรวจสอบครุภัณฑ์ </h2>
                        </div>
                    </div>
                </div>

                <div class="container-fluid text-center mt-3">
                    <table class="table  mt-2" id="mytable" style="width:100%">
                        <thead>
                            <tr>
                                <!-- <th>year_alert</th> -->
                                <th>ปี</th>
                                <th>วันเริ่มต้น</th>
                                <th>วันสิ้นสุด</th>
                                <!-- <th>แก้ไขวันที่</th> -->
                            </tr>
                        </thead>
                    </table>
                </div>


            </div>
        </div>
    </div>

    <br><br><br><br><br>






    <!-- Footer -->
    <footer class="page-footer font-small blue " style="background-color: #253b6d;">

        <!-- Copyright -->
        <div class="footer-copyright text-center py-3 text-light">© 2020 POWERSOL</div>
        <!-- Copyright -->

    </footer>
    <!-- Footer -->

</body>

<script>
    $(document).ready(function () {
        $.ajax({
            method: "GET",
            url: "/profile/userinfor"
        }).done(function (dataSet, state, xhr) {
            var email = dataSet.email;
            console.log(dataSet.name);
            console.log(dataSet.email);
            if (dataSet.name == undefined) {
                window.location.replace('/');
            } else {
                $.ajax({
                    type: "GET",
                    url: "/CheckRole/" + email
                }).done(function (data, state, xhr) {
                    console.log(data[0].role);
                    if (data[0].role == 1) {
                        window.location.replace("/assignCheckingDate");
                    } else if (data[0].role == 0) {
                        $('#NameUser').html(dataSet.name)
                        $('#imguser').attr("src", "" + dataSet.photo + "");
                    } else if (email == undefined) {
                        window.location.replace('/');
                    }
                }).fail(function (xhr, state, err) {
                    console.log(err);
                })
            }
            // window.location.replace('/committeefirstpage')

        }).fail(function (xhr, state, err) {
            // console.log(err)
        })

        tableUser = $("#mytable").DataTable({
            // data: dataSet,
            // "searching": false,
            // "paging": false,
            "ordering": false,
            "info": false,
            "lengthChange": false,
            deferRender: true,
            responsive: true,
            columns: [
                { data: "year_alert" },
                { data: "date_start" },
                { data: "date_end" },
            ],

        });
        productadmin()
    });

    function productadmin() {

        $.ajax({
            method: "GET",
            url: "/datealert"
        }).done(function (dataSet, state, xhr) {
            console.log(dataSet)
            //clear DataTable
            tableUser.clear();
            //display modified JSON in DataTable
            tableUser.rows.add(dataSet).draw();

            var tr = document.getElementById("mytable").getElementsByTagName("TR");
            tr[1].className = "highlightRow"

        }).fail(function (xhr, state, error) {
            //get data failed
            alert(xhr.responseText);
        });
    }
</script>

</html>